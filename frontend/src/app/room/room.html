<div class="room-container">
  <aside class="sidebar">
    <div class="sidebar-header">
      <h2>Users ({{ users().length }})</h2>
      <div class="room-id">Room: {{ roomId() }}</div>
    </div>

    <div class="users-list">
      <ul>
        @for (user of users(); track user.id) {
        <li [class.vacation]="user.isVacation" [class.winner]="user.hasWon">
          <div class="user-info">
            <span class="user-name">{{ user.name }}</span>
            @if (user.isVacation) { <span class="badge vacation-badge">Urlop</span> }
            @if (user.hasWon) { <span class="badge winner-badge">WygraÅ‚</span> }
          </div>
          <div class="user-actions">
            <button tuiButton appearance="flat" size="s" (click)="toggleVacation(user)" [disabled]="isLotteryRunning()"
              class="icon-btn" [title]="user.isVacation ? 'PrzywrÃ³Ä‡' : 'WyÅ›lij na urlop'">
              {{ user.isVacation ? 'â˜€ï¸' : 'ğŸ–ï¸' }}
            </button>
            <button tuiButton appearance="flat" size="s" (click)="toggleWinner(user)" [disabled]="isLotteryRunning()"
              class="icon-btn" [title]="user.hasWon ? 'Cofnij wygranÄ…' : 'Oznacz jako wygranego'">
              {{ user.hasWon ? 'âŒ' : 'ğŸ†' }}
            </button>
            <button tuiButton appearance="flat" size="s" (click)="removeUser(user.id)" [disabled]="isLotteryRunning()"
              class="icon-btn delete-btn" title="UsuÅ„">ğŸ—‘ï¸</button>
          </div>
        </li>
        }
      </ul>
    </div>

    <div class="add-user-form">
      <input type="text" [formControl]="nameControl" placeholder="Enter nickname" (keydown.enter)="addUser()" />
      <button tuiButton size="m" (click)="addUser()" [disabled]="nameControl.invalid">Add</button>
    </div>
  </aside>

  <main class="main-content">
    <div class="lottery-arena">
      @if (!isLotteryRunning() && !currentlyDisplayedName() && !winner()) {
      <button tuiButton appearance="primary" size="xl" class="draw-button" (click)="startLottery()"
        [disabled]="users().length === 0">
        LOSUJ
      </button>
      }

      @if (isLotteryRunning()) {
      <div class="drawing-animation">
        <h3>Losowanie...</h3>
        <div class="rolling-name">{{ currentlyDisplayedName() }}</div>
      </div>
      }

      @if (!isLotteryRunning() && winner()) {
      <div class="winner-display">
        <h3>ZwyciÄ™zca!</h3>
        <div class="winner-name">{{ winner()?.name }}</div>
        <button tuiButton appearance="outline" class="reset-button" (click)="startLottery()">Losuj ponownie</button>
      </div>
      }
    </div>
  </main>
</div>